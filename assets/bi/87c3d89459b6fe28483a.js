"use strict";(self.webpackChunkaesirx_analytics=self.webpackChunkaesirx_analytics||[]).push([[9038],{79038:(t,e,a)=>{a.r(e),a.d(e,{default:()=>R});var s=a(77053),i=a(65925),r=a(20513),n=a(70069),o=a(23541),l=a(67294),c=a(16550),u=a(68949),h=a(73022),d=a(26982),m=a(30381),g=a.n(m),p=a(38585),b=a(91072),A=a(34155),E=class{constructor(){(0,o.o)(this,"getVisitor",(async(t,e,a,s)=>{try{const i=new h.Q22,r=await i.getVisitor(t,e);r&&"AxiosError"!==r?.name?(0,u.z)((()=>{a(r)})):s({message:r?.response?.data?.error||"Something went wrong from Server response"})}catch(t){(0,u.z)((()=>{t.response?.data.message?s({message:t.response?.data?.message}):t.response?.data.error?s({message:t.response?.data?.error}):s({message:t?.response?.data?._messages?t.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.o)(this,"getAttribute",(async(t,e,a,s)=>{try{const i=new h.Q22,r=await i.getAttribute(t,e);r&&"AxiosError"!==r?.name?(0,u.z)((()=>{a(r)})):s({message:r?.response?.data?.error||"Something went wrong from Server response"})}catch(t){(0,u.z)((()=>{t.response?.data.message?s({message:t.response?.data?.message}):t.response?.data.error?s({message:t.response?.data?.error}):s({message:t?.response?.data?._messages?t.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.o)(this,"getAttributeDate",(async(t,e,a,s)=>{try{const i=new h.Q22,r=await i.getAttributeDate(t,e);r&&"AxiosError"!==r?.name?(0,u.z)((()=>{a(r)})):s({message:r?.response?.data?.error||"Something went wrong from Server response"})}catch(t){(0,u.z)((()=>{t.response?.data.message?s({message:t.response?.data?.message}):t.response?.data.error?s({message:t.response?.data?.error}):s({message:t?.response?.data?._messages?t.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}}))}},S=class{constructor(t,e){(0,o.o)(this,"data",null),(0,o.o)(this,"globalViewModel",null),(0,o.o)(this,"toRaw",(()=>this.data)),(0,o.o)(this,"handleChangeLink",((t,e)=>{t.preventDefault(),e&&this.globalViewModel.setIntegrationLink(e)})),(0,o.o)(this,"transformResponseAcquisitionCampaign",(()=>{let t={};return this.data?.length>0&&this.data?.forEach((e=>{e.values?.forEach((e=>{const a=this.data.filter((t=>t?.values.some((t=>t?.value===e?.value))));t={...t,[e?.value]:a}}))})),t})),(0,o.o)(this,"getFilterNameAcquisitionCampaign",(()=>{const t=this.transformResponseAcquisitionCampaign(),e=Object.keys(t).map((t=>({value:t,label:t})));return e?.unshift({value:"all",label:"All"}),e})),(0,o.o)(this,"getListLineAcquisitionCampaign",(()=>{const t=this.transformResponseAcquisitionCampaign();return Object.keys(t).map((t=>t))})),(0,o.o)(this,"toBarChartAcquisitionCampaign",(()=>{const t=this.transformResponseAcquisitionCampaign();return Object.keys(t).map((e=>({name:e,number:t[e]?.map((t=>t?.values?.find((t=>t?.value===e))?.count))?.reduce(((t,e)=>parseInt(t)+parseInt(e)),0)})))})),(0,o.o)(this,"toAreaChartAcquisitionCampaign",(()=>{const t=this.transformResponseAcquisitionCampaign(),e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=(0,h.F9f)(this.globalViewModel.dateFilter.date_start,this.globalViewModel.dateFilter.date_end),s={all:a.map((e=>({name:e&&g()(e,"YYYY-MM-DD").format("MM-DD"),...Object.keys(t).map((a=>{const s=t[a]?.filter((t=>g()(t[h.zAx.DATE]).format("YYYY-MM-DD")===e));return{[a]:s?.length?s[0]?.values?.find((t=>t?.value===a))?.count:0}})).reduce(((t,e)=>({...e,...t})),{})}))),...Object.keys(t).map((e=>({[e]:a.map((a=>{const s=t[e]?.filter((t=>g()(t[h.zAx.DATE]).format("YYYY-MM-DD")===a));return{name:a&&g()(a,"YYYY-MM-DD").format("MM-DD"),[e]:s?.length?s[0]?.values?.find((t=>t?.value===e))?.count:0}}))}))).reduce(((t,e)=>({...e,...t})),{})};return[{all:e.map(((e,a)=>({name:e,...Object.keys(t).map((e=>{const s=t[e].filter((t=>g()(t[h.zAx.DATE]).month()===a));return{[e]:s?.length?s[0]?.values?.find((t=>t?.value===e))?.count:0}})).reduce(((t,e)=>({...e,...t})),{})}))),...Object.keys(t).map((a=>({[a]:e.map(((e,s)=>{const i=t[a].filter((t=>g()(t[h.zAx.DATE]).month()===s));return{name:e,[a]:i?.length?i[0]?.values?.find((t=>t?.value===a))?.count:0}}))}))).reduce(((t,e)=>({...e,...t})),{})},s]})),(0,o.o)(this,"toEventTableAcquisitionCampaign",(()=>{const t=["txt_campaign","txt_page_views","txt_unique_page_views","txt_bounce_rate","txt_page_session","txt_acg_session_duration"],e=["value",h.lF8.NUMBER_OF_PAGE_VIEWS,h.lF8.NUMBER_OF_UNIQUE_PAGE_VIEWS,h.lF8.BOUNCE_RATE,h.lF8.NUMBER_OF_PAGES_PER_SESSION,h.lF8.AVERAGE_SESSION_DURATION];if(this.data?.length){const a=e.map(((e,a)=>({Header:t[a],accessor:e,Cell:({cell:t,column:e})=>e.id===h.lF8.BOUNCE_RATE?l.createElement("div",{className:"px-3"},t?.value+"%"):e.id===h.lF8.AVERAGE_SESSION_DURATION?l.createElement("div",{className:"px-15"},t?.value?g().utc(1e3*t?.value).format("HH:mm:ss"):"00:00:00"):l.createElement("div",{className:"px-15"},t?.value??null)}))),s=this.data?.map((t=>({...t,...e.map((e=>({[e]:t[e]}))).reduce(((t,e)=>({...e,...t})),{})}))),i=s?.map((t=>{for(let a in t)e.includes(a)||delete t[a];return t}));return{header:a,data:i}}return{header:[],data:[]}})),(0,o.o)(this,"toAttributeList",(()=>{const t=this.transformResponseAcquisitionCampaign(),e=Object.keys(t)?.map((t=>({value:t,label:t})));return[{label:"All Campaign",value:"all"},...e]})),t&&(this.data=t,this.globalViewModel=e)}},_=class{constructor(t,e){(0,o.o)(this,"acquisitionCampaignStore",null),(0,o.o)(this,"statusAttribute",r.r.READY),(0,o.o)(this,"statusAttributeList",r.r.READY),(0,o.o)(this,"statusTable",r.r.READY),(0,o.o)(this,"globalStoreViewModel",null),(0,o.o)(this,"data",null),(0,o.o)(this,"dataFilter",{}),(0,o.o)(this,"attributeData",null),(0,o.o)(this,"dataAttribute",null),(0,o.o)(this,"dataAttributeList",null),(0,o.o)(this,"sortBy",{"sort[]":"","sort_direction[]":""}),(0,o.o)(this,"transformDataToAcquisitionCampaignModel",(()=>new S(this.data))),(0,o.o)(this,"getAttributeTable",((t,e,a={"sort[]":"start","sort_direction[]":"desc"})=>{this.statusTable=r.r.LOADING,this.sortBy=a,this.dataFilterTable={page_size:"5",...this.dataFilterTable,...t,...this.sortBy},"all"===t["filter[attribute_value]"]&&this.dataFilterTable["filter[attribute_value]"]&&delete this.dataFilterTable["filter[attribute_value]"];const s={...this.globalStoreViewModel.dateFilter,...e};this.acquisitionCampaignStore.getAttribute(this.dataFilterTable,s,this.callbackOnDataSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"getAttributeList",((t,e)=>{this.statusTable=r.r.LOADING,this.dataFilterAttributeList={page_size:"5",...this.dataFilterAttributeList,...t};const a={...this.globalStoreViewModel.dateFilter,...e};this.acquisitionCampaignStore.getAttribute(this.dataFilterAttributeList,a,this.callbackOnDataAttributeListSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"getAttributeDate",((t,e)=>{this.statusAttribute=r.r.LOADING,this.dataFilterAttribute={page_size:"1000",...this.dataFilterAttribute,...t};const a={...this.globalStoreViewModel?.dateFilter,...e};this.acquisitionCampaignStore.getAttributeDate(this.dataFilterAttribute,a,this.callbackOnDataAttributeSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"setDataFilter",(t=>{this.dataFilter=t})),(0,o.o)(this,"handleFilterDateRange",((t,e)=>{this.statusAttribute=r.r.LOADING,this.statusTable=r.r.LOADING;const a={...this.globalStoreViewModel.dateFilter,date_start:g()(t).format("YYYY-MM-DD"),date_end:g()(e).endOf("day").format("YYYY-MM-DD")};this.dateFilter={...this.dateFilter,...a},this.acquisitionCampaignStore.getAttributeTable(this.dataFilterTable,a,this.callbackOnDataSuccessHandler,this.callbackOnErrorHandler),this.acquisitionCampaignStore.getAttributeDate(this.dataFilterAttribute,a,this.callbackOnDataAttributeSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"handleFilterTable",(async t=>{this.statusTable=r.r.LOADING,this.dataFilterTable={...this.dataFilterTable,...t};const e={...this.globalStoreViewModel.dateFilter};await this.acquisitionCampaignStore.getAttributeTable(this.dataFilterTable,e,this.callbackOnDataSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"callbackOnErrorHandler",(t=>{this.statusAttribute=r.r.READY,this.statusTable=r.r.READY,(0,d.j5)(t.message,"error")})),(0,o.o)(this,"callbackOnDataSuccessHandler",(t=>{if(t){if("canceled"!==t?.message){this.statusTable=r.r.READY;const e=t?.list[0]?.values?.map((t=>({value:t?.value,[h.lF8?.NUMBER_OF_VISITORS]:t[h.lF8?.NUMBER_OF_VISITORS],[h.lF8?.TOTAL_NUMBER_OF_VISITORS]:t[h.lF8?.TOTAL_NUMBER_OF_VISITORS],[h.lF8?.AVERAGE_SESSION_DURATION]:t[h.lF8?.AVERAGE_SESSION_DURATION],[h.lF8?.NUMBER_OF_PAGES_PER_SESSION]:t[h.lF8?.NUMBER_OF_PAGES_PER_SESSION],[h.lF8?.BOUNCE_RATE]:t[h.lF8?.BOUNCE_RATE]}))),a=new S(e,this.globalStoreViewModel);this.data={list:a,pagination:t.pagination}}}else this.statusTable=r.r.ERROR,this.data=[]})),(0,o.o)(this,"callbackOnDataAttributeSuccessHandler",(t=>{if(t){if("canceled"!==t?.message){this.statusAttribute=r.r.READY;const e=new S(t,this.globalStoreViewModel);this.dataAttribute=e}}else this.statusAttribute=r.r.ERROR,this.data=[]})),(0,o.o)(this,"callbackOnDataAttributeListSuccessHandler",(t=>{if(t){if("canceled"!==t?.message){this.statusAttributeList=r.r.READY;const e=new S(t?.list,this.globalStoreViewModel);this.dataAttributeList=e}}else this.statusAttributeList=r.r.ERROR,this.data=[]})),(0,u.ky)(this),this.acquisitionCampaignStore=t,this.globalStoreViewModel=e}},O=class{constructor(t,e){(0,o.o)(this,"acquisitionCampaignEvents",null),(0,o.o)(this,"getAcquisitionCampaignListModel",(()=>this.acquisitionCampaignEvents)),t&&(this.acquisitionCampaignEvents=new _(t,e))}},v=(0,l.lazy)((()=>Promise.all([a.e(7398),a.e(1744),a.e(6656),a.e(8032),a.e(9843)]).then(a.bind(a,39843)))),D=({link:t,...e})=>l.createElement(v,{...e}),w=(0,p.Pi)(class extends l.Component{constructor(t){super(t),(0,o.o)(this,"acquisitionCampaignStore",null),(0,o.o)(this,"acquisitionCampaignViewModel",null);const{viewModel:e}=t;this.viewModel=e||null,this.biListViewModel=this.viewModel?this.viewModel.getBiListViewModel():null,this.acquisitionCampaignStore=new E({}),this.acquisitionCampaignViewModel=new O(this.acquisitionCampaignStore,this.biListViewModel)}render(){const{integration:t=!1}=this.props,{integrationLink:e,activeDomain:a}=this.biListViewModel,r=(0,c.LX)(d.m8.location.pathname,{path:A.env.REACT_APP_INTERGRATION?"/bi":"/acquisition/campaigns",exact:!0,strict:!1});return l.createElement(s.G,{viewModel:this.acquisitionCampaignViewModel},(r?.isExact||"acquisition-campaigns"===e)&&l.createElement(i.V,{data:this?.acquisitionCampaignViewModel?.acquisitionCampaignEvents?.data?.list?.toEventTableAcquisitionCampaign(!0)?.data,i18n:this.props.i18n,t:this.props.t,componentRef:this.componentRef,sectionName:"acquisition-campaigns"}),l.createElement(F,{integration:t,integrationLink:e,activeDomain:a,ref:t=>this.componentRef=t}))}}),F=(0,p.Pi)(class extends l.Component{constructor(t){super(t)}render(){return l.createElement("div",{className:"aesirxui"},this.props.integration?l.createElement(D,{link:this.props.integrationLink,activeDomain:this.props.activeDomain,...this.props}):l.createElement(l.Fragment,null,l.createElement(c.AW,{exact:!0,path:["/acquisition/campaigns","/bi/acquisition-campaigns"]},l.createElement(v,null))))}}),R=(0,b.Zh)()((0,n.NQ)(w))},77053:(t,e,a)=>{a.d(e,{G:()=>r,t:()=>n});var s=a(67294),i=s.createContext(),r=({children:t,viewModel:e})=>s.createElement(i.Provider,{value:e},t),n=()=>s.useContext(i)}}]);