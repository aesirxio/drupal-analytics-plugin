"use strict";(self.webpackChunkaesirx_analytics=self.webpackChunkaesirx_analytics||[]).push([[8642],{48642:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var a=s(84941),i=s(65925),n=s(65907),l=s(20513),r=s(70069),o=s(23541),c=s(67294),h=s(91072),d=s(38585),g=s(16550),u=s(68949),m=s(73022),E=s(26982),p=s(30381),w=s.n(p),S=s(12086),O=s(70982),R=s(59417),b=s(34155),k=class{constructor(){(0,o.o)(this,"getVisits",(async(e,t,s,a)=>{try{const i=new m.Q22,n=await i.getVisits(e,t);n?(0,u.z)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,u.z)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}})),(0,o.o)(this,"getOutlink",(async(e,t,s,a)=>{try{const i=new m.Q22,n=await i.getOutlink(e,t);n?(0,u.z)((()=>{s(n)})):a({message:"Something went wrong from Server response"})}catch(e){(0,u.z)((()=>{e.response?.data.message?a({message:e.response?.data?.message}):a({message:e?.response?.data?._messages?e.response?.data?._messages[0]?.message:"Something went wrong from Server response"})}))}}))}},v=class{constructor(e,t){(0,o.o)(this,"data",[]),(0,o.o)(this,"globalViewModel",null),(0,o.o)(this,"toRaw",(()=>this.data)),(0,o.o)(this,"toOutlinkTableTop",(()=>{const e=["","txt_search_engines","txt_visits"],t=[m.wsZ.URLS,m.wsZ.REFERER,m.lF8.TOTAL_NUMBER_OF_VISITORS];if(this.data?.length){const s=t.map(((t,s)=>({Header:e[s],accessor:t,allowSort:!0,width:t===m.wsZ.REFERER?300:t===m.lF8.NUMBER_OF_UNIQUE_PAGE_VIEWS?220:t===m.wsZ.URLS?20:170,Cell:({cell:e,column:t,row:s})=>t.id===m.wsZ.REFERER?c.createElement(c.Fragment,null,c.createElement("a",{href:`//${e?.value}`,target:"_blank",rel:"noreferrer",className:"px-15 d-block text-secondary-50"},c.createElement("span",null,e?.value))):t.id===m.lF8.BOUNCE_RATE?c.createElement("div",{className:"px-3 text-end"},e?.value+"%"):t.id===m.lF8.AVERAGE_SESSION_DURATION?c.createElement("div",{className:"px-15 text-end"},e?.value?w().utc(1e3*e?.value).format("HH:mm:ss"):"00:00:00"):t.id===m.wsZ.URLS?e?.value?.length?c.createElement("span",{...s.getToggleRowExpandedProps({style:{paddingLeft:2*s.depth+"rem"}})},s.isExpanded?c.createElement("i",{className:"ms-2 fs-5 text-success"},c.createElement(O.G,{icon:R.El_})):c.createElement("i",{className:"ms-2 fs-5 text-success"},c.createElement(O.G,{icon:R.CPW}))):null:c.createElement("div",{className:"px-15 text-end"},e?.value??null),SubCell:({column:e,value:t})=>e.id===m.wsZ.REFERER?c.createElement(c.Fragment,null,c.createElement("a",{href:`//${t}`,target:"_blank",rel:"noreferrer",className:"px-15 d-block text-secondary-50"},c.createElement("span",null,t))):c.createElement("div",{className:"px-15 text-end"},t??null)}))),a=this.data?.map((e=>({...e,...t.map((t=>t===m.wsZ.URLS?{[t]:e[t]?.map((e=>({referer:e?.url,...e})))}:{[t]:e[t]})).reduce(((e,t)=>({...t,...e})),{})}))),i=a?.map((e=>{for(let s in e)t.includes(s)||delete e[s];return e}));return{header:s,data:i}}return{header:[],data:[]}})),e&&(this.data=e??[],this.globalViewModel=t)}},F=class{constructor(e,t){(0,o.o)(this,"searchEngineStore",null),(0,o.o)(this,"status",l.r.READY),(0,o.o)(this,"statusOverview",l.r.READY),(0,o.o)(this,"statusMetrics",l.r.READY),(0,o.o)(this,"statusTopTable",l.r.READY),(0,o.o)(this,"globalStoreViewModel",null),(0,o.o)(this,"metricsData",null),(0,o.o)(this,"searchEngineData",null),(0,o.o)(this,"visitsData",null),(0,o.o)(this,"outlinkTableData",null),(0,o.o)(this,"sortBy",{"sort[]":"","sort_direction[]":""}),(0,o.o)(this,"initialize",((e,t,s)=>{this.getVisits(e,t),this.getOutlink(e,t,s,{})})),(0,o.o)(this,"getVisits",((e,t)=>{this.statusOverview=l.r.LOADING,this.dataFilter={...this.dataFilter,...e};const s={...this.globalStoreViewModel.dateFilter,...t};this.searchEngineStore.getVisits({...this.dataFilter,page_size:"1000"},s,this.callbackOnVisitsSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"getOutlink",(async(e,t,s={},a={})=>{this.statusTopTable=l.r.LOADING,this.sortBy=s,this.search=a,this.dataFilterOutlink={page_size:"5",...this.dataFilterOutlink,...e,...this.sortBy,...this.search};const i={...this.globalStoreViewModel.dateFilter,...t};await this.searchEngineStore.getOutlink(this.dataFilterOutlink,i,this.callbackOnOutlinkSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"handleFilter",(e=>{this.status=l.r.LOADING,this.dataFilter={...this.dataFilter,...e};const t={...this.globalStoreViewModel.dateFilter};this.searchEngineStore.getMetrics(this.dataFilter,t,this.callbackOnDataSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"handleFilterChannel",(async e=>{this.statusTopTable=l.r.LOADING,this.dataFilterChannel={...this.dataFilterChannel,...e};const t={...this.globalStoreViewModel.dateFilter};if(await this.searchEngineStore.getChannel(this.dataFilterChannel,t,this.callbackOnChannelSuccessHandler,this.callbackOnErrorHandler),this.globalStoreViewModel.dataFilter={pagination:this.dataFilterChannel?.page},e?.page){const t={...S.Z.parse(location.search),pagination:e?.page};window.history.replaceState("","",`/behavior?${S.Z.stringify(t)}`)}})),(0,o.o)(this,"handleFilterDateRange",((e,t)=>{this.status=l.r.LOADING;let s={date_start:w()(e).format("YYYY-MM-DD"),date_end:w()(t).endOf("day").format("YYYY-MM-DD")};this.initialize(this.dataFilter,s)})),(0,o.o)(this,"handleFilterOutlink",(async e=>{this.statusTopTable=l.r.LOADING,this.dataFilterOutlink={...this.dataFilterOutlink,...e};const t={...this.globalStoreViewModel.dateFilter};await this.searchEngineStore.getOutlink(this.dataFilterOutlink,t,this.callbackOnOutlinkSuccessHandler,this.callbackOnErrorHandler)})),(0,o.o)(this,"callbackOnErrorHandler",(e=>{this.status=l.r.READY,(0,E.j5)(e.message,"error")})),(0,o.o)(this,"callbackOnVisitsSuccessHandler",(e=>{if(e?.length){if("canceled"!==e?.message){this.statusOverview=l.r.READY;const t=new a.I(e,this.globalStoreViewModel);this.visitsData=t}}else this.status=l.r.ERROR,this.statusOverview=l.r.ERROR,this.data=[]})),(0,o.o)(this,"callbackOnOutlinkSuccessHandler",(e=>{if(e){if("canceled"!==e?.message){this.statusTopTable=l.r.READY;const t=new v(e.list,this.globalStoreViewModel);this.outlinkTableData={list:t,pagination:e.pagination}}}else this.status=l.r.ERROR,this.statusTopTable=l.r.ERROR,this.data=[]})),(0,u.ky)(this),this.searchEngineStore=e,this.globalStoreViewModel=t}},M=class{constructor(e,t){(0,o.o)(this,"searchEngineListViewModel",null),(0,o.o)(this,"getSearchEngineListViewModel",(()=>this.searchEngineListViewModel)),e&&(this.searchEngineListViewModel=new F(e,t))}},V=(0,c.lazy)((()=>Promise.all([s.e(7398),s.e(1744),s.e(6656),s.e(8032),s.e(834)]).then(s.bind(s,50834)))),f=({link:e,...t})=>c.createElement(V,{...t}),D=(0,d.Pi)(class extends c.Component{constructor(e){super(e),(0,o.o)(this,"SearchEngineStore",null),(0,o.o)(this,"SearchEngineViewModel",null);const{viewModel:t}=e;this.viewModel=t||null,this.biListViewModel=this.viewModel?this.viewModel.getBiListViewModel():null,this.SearchEngineStore=new k,this.SearchEngineViewModel=new M(this.SearchEngineStore,this.biListViewModel)}render(){const{integration:e=!1}=this.props,{integrationLink:t,activeDomain:s}=this.biListViewModel,a=(0,g.LX)(E.m8.location.pathname,{path:b.env.REACT_APP_INTERGRATION?"/bi":"/acquisition/search-engines",exact:!0,strict:!1}),l=a?.isExact||this?.SearchEngineViewModel?.searchEngineListViewModel?.pagesTableData?.list?.data;return c.createElement(n.p,{viewModel:this.SearchEngineViewModel},c.createElement(i.V,{data:l,i18n:this.props.i18n,t:this.props.t,componentRef:this.componentRef,sectionName:a?.isExact||"search-engines"}),c.createElement(x,{integration:e,integrationLink:t,activeDomain:s,ref:e=>this.componentRef=e}))}}),x=(0,d.Pi)(class extends c.Component{constructor(e){super(e)}render(){return c.createElement("div",{className:"aesirxui"},this.props.integration?c.createElement(f,{link:this.props.integrationLink,activeDomain:this.props.activeDomain,...this.props}):c.createElement(c.Fragment,null,c.createElement(g.AW,{exact:!0,path:["/acquisition/search-engines","/bi/acquisition-search-engines"]},c.createElement(V,{...this.props}))))}}),_=(0,h.Zh)()((0,g.EN)((0,r.NQ)(D)))},65907:(e,t,s)=>{s.d(t,{i:()=>l,p:()=>n});var a=s(67294),i=a.createContext(),n=({children:e,viewModel:t})=>a.createElement(i.Provider,{value:t},e),l=e=>t=>a.createElement(e,{...t,viewModel:a.useContext(i)})}}]);