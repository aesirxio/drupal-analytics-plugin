"use strict";(self.webpackChunkaesirx_analytics=self.webpackChunkaesirx_analytics||[]).push([[3572],{42217:(e,t,n)=>{var a=n(82617);t.mw={prefix:a.prefix,iconName:a.iconName,icon:[a.width,a.height,a.aliases,a.unicode,a.svgPathData]},t.SG=t.mw,a.prefix,a.iconName,a.width,a.height,a.aliases,a.unicode,a.svgPathData,a.aliases},82617:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n="circle-check",a=[61533,"check-circle"],s="f058",r="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209L241 337c-9.4 9.4-24.6 9.4-33.9 0l-64-64c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l47 47L335 175c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9z";t.definition={prefix:"fas",iconName:n,icon:[512,512,a,s,r]},t.faCircleCheck=t.definition,t.prefix="fas",t.iconName=n,t.width=512,t.height=512,t.ligatures=a,t.unicode=s,t.svgPathData=r,t.aliases=a},71191:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var a=n(25219),s=n(34538),r=(n(69171),n(74792)),c=n(44456),o=n(54258),i=(n(24899),n(96540)),l=n(9072),m=n(73650),u=n(10159),d=n(44479),p=n(61105),g=n(67676),w=n(51535),h=n(49582),E=({isConnecting:e,handleOnConnect:t,activeConnectorError:n,activeConnectorType:s,activeConnector:r,noLogin:c})=>i.createElement(i.Fragment,null,i.createElement("div",{className:""},i.createElement(d.A,null,i.createElement(p.A,{lg:""+(c?"6":"12")},u.xl?i.createElement("button",{disabled:e,type:"button",className:"btn btn-dark btn-concordium fw-medium text-nowrap py-2 px-4 fs-18 lh-sm text-white d-flex align-items-center justify-content-start w-100 "+(c?"mb-3 mb-lg-0":"mb-3"),onClick:()=>t(a.p,"browser")},e?i.createElement(i.Fragment,null,i.createElement("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),"Connecting"):i.createElement(i.Fragment,null,i.createElement("img",{src:a.OD,className:"me-3 align-text-bottom",alt:"Concordium",width:24}),"Concordium Browser Wallet")):u.m0?i.createElement(i.Fragment,null,i.createElement("button",{className:"btn btn-dark btn-concordium flex-grow-1 fw-medium py-2 px-4 fs-18 lh-sm text-white d-flex align-items-center justify-content-start w-100",onClick:()=>t(a.T$,"walletconnect")},n||!s||r?i.createElement(i.Fragment,null,i.createElement("div",{className:"d-flex text-start align-items-center"},i.createElement("p",{className:"mb-0 fs-18 text-nowrap pe-3 me-3 border-end text-nowrap"},"QR Code"),i.createElement("p",{className:"mb-0 fs-12"},"Concordium or CryptoX Mobile Wallets"))):i.createElement("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}))):i.createElement(i.Fragment,null)))),u.Fr&&u.m0&&i.createElement("div",{className:"bg-success-light p-3 mt-3 fs-14 text-start"},i.createElement("p",{className:"mb-1 fw-bold"},"Note for Concordium Wallet:"),i.createElement("p",{className:"mb-0"},"Please connect & sign your signature on the app then switch back to the browser to continue"))),b=({account:e,connection:t,setIsAccountExist:n,setExpand:u,setAccountInfo:d,noSignUpForm:p})=>{const[w,h]=(0,i.useState)(""),[E,b]=(0,i.useState)(!0),[f,x]=(0,i.useState)(!1),[C,y]=(0,i.useState)(!1),[N,v]=(0,i.useState)(!1),k="concordium",{noCreateAccount:A,isSignUpForm:S,handleOnData:F,toggle:I,isRequireEmail:P}=(0,i.useContext)(c.kF),{getWalletNonce:R,verifySignature:W}=(0,s.P)(k,e),L=async()=>{y(!0);try{const t=await(0,c.s5)(e??""),n=await(0,c.gL)(),a=await(0,g.Cr)(),s=await a.requestIdProof(e??"",n,t);return await(0,c.Gr)(t,s)&&(x(!0),y(!1)),!0}catch(e){return x(!1),y(!1),!1}};return i.createElement(i.Fragment,null,N&&!p?i.createElement(i.Fragment,null,i.createElement("div",{className:"text-start"},i.createElement("div",{className:"cursor-pointer fw-medium fs-14 d-inline-flex align-items-center back-button text-primary",onClick:()=>{v(!1),u("wallet"),n({status:!0,type:""})}},i.createElement("img",{src:o.w,alt:"Back Icon",className:"me-1"}),"Back")),i.createElement("div",{className:"text-primary"},i.createElement(r.Y,{setShow:S?I:async()=>{v(!1),u("wallet"),n({status:!0,type:""})},setIsExist:b,setIsAccountExist:n,accountAddress:e,connection:t,wallet:"concordium",isRequireEmail:P}))):i.createElement(i.Fragment,null,i.createElement("button",{disabled:""!==w||C,type:"button",className:"btn btn-dark btn-concordium w-100 fw-medium py-2 px-4 fs-18 lh-sm text-white d-flex align-items-center text-start",onClick:()=>{!E||S?(async()=>{h("loading");try{const t=await(0,c.NO)(e,k);t?.data?.result?l.oR.error("You've already created an account with this wallet."):(f||await L())&&(v(!0),u("wallet-concordium")),h("")}catch(e){h(""),l.oR.error(e?.response?.data?.error||e?.message)}})():(async()=>{h("connect");const a=await R();if(a)try{h("sign");const n=await t.signMessage(e,(0,m.BB)(`${a}`)),s="object"==typeof n&&null!==n?n:JSON.parse(n);if(n){const t=await W(k,e,s);if(P){const e=await(0,c.Xf)(t?.access_token);!e?.email||/@aesirx\.io$/.test(e?.email)&&(e?.wallet_concordium&&e?.email?.includes(e?.wallet_concordium)||e?.wallet_metamask&&e?.email?.includes(e?.wallet_metamask))?(u("require-email"),d({data:t,memberId:e?.member_id})):F({...t,loginType:"concordium"})}else F({...t,loginType:"concordium"})}}catch(e){(0,l.oR)(e.message)}else!A&&b(!1),n({status:!1,type:"concordium"});h("")})()}},w?i.createElement("div",{className:"d-flex align-items-center"},i.createElement("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),i.createElement("span",{className:"ms-1"},"sign"===w?"Please sign message on the wallet":"loading"===w?"Connecting...":"Please wait to connect...")):!E||S?i.createElement(i.Fragment,null,i.createElement("img",{src:a.OD,className:"me-3 align-text-bottom",alt:"Concordium logo",width:24}),C?i.createElement(i.Fragment,null,i.createElement("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}),i.createElement("span",{className:"ms-1"},f?"Loading...":"Authorizing")):i.createElement(i.Fragment,null,"Create account via Concordium (",e&&(0,c.l1)(e),")")):i.createElement(i.Fragment,null,i.createElement("img",{src:a.OD,className:"me-3 align-text-bottom",alt:"Concordium logo",width:24}),"Sign in via Concordium (",e&&(0,c.l1)(e),")"))))},f=e=>{const{activeConnectorType:t,activeConnector:n,activeConnectorError:a,network:r,connectedAccounts:o,genesisHashes:u,setActiveConnectorType:d,setIsAccountExist:p,setExpand:g,setAccountInfo:f,noLogin:x,setAccountAddress:C,setConnectionProvider:y,setWalletType:N,noSignUpForm:v,setWalletState:k}=e,{connection:A,setConnection:S,account:F,genesisHash:I}=(0,m.w5)(o,u),{connect:P,connectError:R,isConnecting:W}=(0,m.eF)(n,S),[L,U]=(0,i.useState)(),[_,T]=(0,i.useState)(""),O=(0,m.Di)(r);(0,i.useEffect)((()=>{O&&(U(void 0),O.getConsensusStatus().then((e=>e.genesisBlock)).then((e=>{const{network:t}=(0,c.NR)();let n=!1;if("testnet"===t)n=h.U5(e)===m.eU.genesisHash;else n=h.U5(e)===m.pF.genesisHash;if(!n){const{network:e}=(0,c.NR)();throw new Error(`Please change the network to ${e} in Wallet`)}U(e),T("")})).catch((e=>{U(void 0),(0,l.oR)(e.message),T(e.message)})))}),[O]),(0,i.useEffect)((()=>{n&&P()}),[n]),(0,i.useEffect)((()=>{C&&(F&&A?(C(F),y(A),N("concordium")):(C(""),y(null),N(""))),k&&F&&A&&k({wallet:"concordium",accountAddress:F,connection:A})}),[F,A]),(0,i.useEffect)((()=>{R&&"A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received"!==R&&(0,l.oR)(R)}),[R]);return i.createElement(i.Fragment,null,!F||_?i.createElement(E,{isConnecting:W,handleOnConnect:async(e,t)=>{w.A.setItem("concordium",t),await d(e)},activeConnectorError:a,activeConnectorType:t,activeConnector:n,noLogin:x}):i.createElement(i.Fragment,null,L?x?i.createElement(s.l,{className:"mb-12px",title:"Account Connected:",value:(0,c.l1)(F,20,5),contentCopy:F}):i.createElement(b,{account:F,connection:A,setIsAccountExist:p,setExpand:g,setAccountInfo:f,noSignUpForm:v,setWalletState:k}):i.createElement("button",{className:"btn btn-dark"},i.createElement("span",{className:"spinner-border spinner-border-sm me-1",role:"status","aria-hidden":"true"}))),a&&i.createElement("div",{className:"mt-1 fs-7 text-danger text-start"},"Connector error: ",a,"."),_&&i.createElement("div",{className:"mt-1 fs-7 text-danger text-start"},"RPC error: ",_))},x=({setIsAccountExist:e,setExpand:t,setAccountInfo:n,noLogin:a,setAccountAddress:s,setConnection:r,setWalletType:o,noSignUpForm:l=!1,setWalletState:u})=>{const{network:d}=(0,c.NR)();return i.createElement(m.DI,{network:"testnet"===d?m.eU:m.pF},(c=>i.createElement(f,{...c,setIsAccountExist:e,setExpand:t,setAccountInfo:n,noLogin:a,setAccountAddress:s,setConnectionProvider:r,setWalletType:o,noSignUpForm:l,setWalletState:u})))}},34538:(e,t,n)=>{n.d(t,{P:()=>u,l:()=>m});var a=n(69171),s=n(44456),r=n(42217),c=n(20982),o=n(96540),i=n(9072),l=n(46266),m=({title:e,value:t,className:n,contentCopy:s})=>o.createElement("div",{className:`custom_tags border text-dark rounded-1 mb-0 py-1 px-20px d-flex justify-content-between fw-semibold ${n}`},o.createElement("span",{className:"d-flex align-items-center"},o.createElement(c.g,{icon:r.SG,width:16,height:16,className:"text-success me-1"}),e),o.createElement("p",{className:"mb-0"},t," ",s&&o.createElement(a.C,{content:s,isBlack:!0,className:"bg-transparent border-0 text-dark px-1"}))),u=(e,t)=>{const{endpoint:n}=(0,s.NR)();return{getWalletNonce:async()=>{try{const a={method:"post",url:`${n}/index.php?webserviceClient=site&webserviceVersion=1.0.0&option=member&task=getWalletNonce&api=hal`,headers:{"Content-Type":"application/json"},data:{publicAddress:t,wallet:e,text:"Login with nonce: {}"}},{data:s}=await(0,l.A)(a);if(s.result)return s.result;throw!1}catch(e){return!1}},verifySignature:async(e,t,a)=>{try{const s=new URLSearchParams(window.location.search)?.get("return"),r=new URLSearchParams(window.location.search)?.get("channel_type"),c=new URLSearchParams(window.location.search)?.get("organisationId"),o={wallet:e,publicAddress:t,signature:a,...r&&{channel_type:r},...s&&{return:s},...c&&{organisationId:c}},i={method:"post",url:`${n}/index.php?webserviceClient=site&webserviceVersion=1.0.0&option=member&task=walletLogin&api=hal&return=${s??null}`,headers:{"Content-Type":"application/json"},data:o},{data:m}=await(0,l.A)(i);if(m?.result)return m?.result;throw!1}catch(e){return(0,i.oR)("Wrong authentication",{closeOnClick:!1}),!1}}}}}}]);